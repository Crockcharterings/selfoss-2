<html><head><title>AutoCAD 如何批量打印？</title></head><body><style type='text/css'>img{display:block;margin:0 auto;}p{font-size: 28px;}</style>
謝邀。<br />這是一個有益於公衆的問題和回答，因此不考慮收費。<br />題主心情急迫，我可以理解，但是很遺憾，這個回答無法馬上就幫到你。<p>AutoCAD 自 2006 版開始，就基本上完善了批量打印，這也是我推薦 AutoCAD 版本不早於 2006 版的原因。批量打印 Publish，是一個高級功能，所謂『高級』，並非指他特別重大或者難以使用，而是，批量打印涉及到一系列初級、中級功能，必須要在他們的基礎上，才能用好。</p><p>批量打印 Publish 命令本身使用並不麻煩，但他涉及的功能很廣汎。如下圖，藍色代表 AutoCAD 自身技術，黃色代表用戶需要掌握的一系列知識。<br /></p><img src="https://pic1.zhimg.com/3ef6d7ce75a9ec6ce30d3290b2d52ad0_b.png" width="1532" alt="image" />一個理想的流程是：<img src="http://zhstatic.zhihu.com/assets/zhihu/ztext/whitedot.jpg" width="1532" alt="image" />一個理想的流程是：<br /><ol><li>在模型空間裏面繪製基本圖紙，並進行標注；</li><li>在圖紙空間裏面進行佈局，並設置好圖框、比例、可視圖層；</li><li>對佈局做頁面設置；</li><li>對其他圖紙做相同設置，這時候可以用模板了；</li><li>所有圖紙設置完成之後，運行 Publish，添加需要打印的全部頁面，然後打印。根據需要選擇是否保存隊列。</li></ol><p>上面沒有提到 Plot Style 設置和 Plotter 設置，因爲那是一勞永逸的基礎工作，不必體現在每一次流程中。</p><p>大家可以留意到，流程 2 ~ 4，是在製圖過程中就需要完成的，而不是臨到出圖時才去一個個折騰。<br /></p><p>關於比例設置，可以參考 <a href="https://www.zhihu.com/question/32003888/answer/54962401">AutoCAD 制图中的各种比例问题如何解决？ - 未有齋的回答</a></p><p>關於圖紙的管理，主要是指到底是合圖還是分圖這個問題。</p><p>很多人喜歡把一個項目自己全部的圖紙都畫在同一個 DWG 文件裏面，以爲這樣很方便。雖然實際上那所謂的『方便』衹是個幻覺，而且問題多多，但不可否認的是，那是一個普遍的『習慣』。什麽事情一觸及到習慣，也就會觸及到面子。所以堅持那種習慣的朋友，你們繼續，高興就好。</p><p>分圖是必須的，尤其是平面圖，不分不足以提高效率。</p><p>那麽如果圖紙已經都畫在一起了，畫在模型空間裏面了，怎麽辦？</p><p>確實有一些基於這種老舊思維的批量打印工具，但我並沒有用過這類工具，所以抽時間寫了段 AutoLISP。</p><p>思路是這樣的：</p><ol><li>用戶自己建立一個不打印的圖層 FL_MPUB，『不打印』這個屬性是關鍵，也是該方法巧妙之處。當然，這個圖層就不要用來放別的東西了；</li><li>用戶在這個圖層裏面，對每一張要打印的圖，在其圖框『對角綫』畫一條 LINE；</li><li>設定好你的打印機，並把需要的設備名稱、圖幅、打印風格填寫到程序當中（我懶得做交互了），並保存；</li><li>加載這個程序，運行。</li></ol><p>這個程序會查找 FL_MPUB 圖層上所有的 LINE，然後遍歷得到每一條綫的起始點，用於指定打印窗口，隨即用窗口方式打印。</p><p>請注意：</p><ol><li>要填寫設備名稱、圖幅、打印風格等參數；</li><li>我是用 PDF 打印機調試的，PDF 打印機需要一個輸出文件，程序按打印順序自動生成了。但如果輸出到硬設備，需要刪除（或注釋掉）第 28 行；</li><li>硬設備打印應該會遇到一個是否打印到文件的交互，我沒有條件調試，請使用者自己留意。<br /></li></ol><div><pre><code>(defun c:mpub (\ mpub_s mpub_l mpub_pt1 mpub_pt2 n mpub_nam)
  (if (tblsearch "layer" "FL_MPUB")
    (if (setq mpub_s (ssget "x" '((0 . "line")(8 . "FL_MPUB"))))
      (progn
        (setq mpub_a (sslength mpub_s) n 0)
        (repeat mpub_a
          (setq mpub_l (entget (ssname mpub_s n))
                mpub_pt1 (cdr (assoc 10 mpub_l))
                mpub_pt2 (cdr (assoc 11 mpub_l))
                mpub_nam (strcat (getvar "dwgname") "_" (rtos n 2 0))
          )
          (command	"-plot"
			"y"
			""
			"DWG To PDF"
			""
			"m"
			"l"
			"n"
			"w"
			mpub_pt1 mpub_pt2
			"F"
			"C"
			""
			"ACAD.CTB"
			"N"
			""
			mpub_nam
			"N"
			"Y"
	  )
	  (setq n (1+ n))
        );repeat
      );progn
    );if lines
  );if layer exist
  (princ)
);defun
</code></pre></div><p><br />以上代碼，請隨意使用，本人不維護，不提供技術支持。</p><p>很顯然，這種基於模型空間的批量打印，存在很多大問題。</p><ol><li>無法處理 3D 模型的打印；</li><li>難以處理多個 UCS 的情況。對，上面的代碼就沒有考慮 UCS，所以用 UCS 的朋友會遇到問題；</li><li>難以處理圖層組合，更無法『固化』圖層組合。一定要做的話，我估計用 Xdata 附著圖層狀態代號，可能也行得通，不過那真的叫閒得蛋疼。<br /></li></ol><p>所以，應急的話，可以試試這個辦法，長遠地看，還是學學怎樣使用 Layout 吧。</p><p>------------------<br /></p><p>順便也說說模型空間多圖的弊端：</p><ol><li>上面提到了的，3D 模型無法出圖。</li><li>上面提到的圖層固化不能。喜歡用模型空間的，一般會用到『圖層狀態管理器』，有幫助，但仍然需要人為控制，而無法『固化』設置，時間久了或者 DWG 提交給他人，就迷糊了。而且合圖的情況下，又要切換圖層組合，又要自動化批量打印，還真是令人為難啊。</li><li>由於不能『固化圖層』，因此處理一底多圖的情況就會非常麻煩。一底多圖，是景觀設計、總圖設計特別需要的技術。一定要采用模型空間搞定一切的話，XREF 也可以做到一底多圖，甚至也能實現『固化圖層』。但還是用佈局更直接、方便，XREF 和佈局也不對立。而且，一旦開始用上 XREF，實際上就已經接受分圖思想了。<br /></li><li>在分工合作時，外部引用 XREF 是極為便利的技術，而 XREF 的被引用圖必然要求分圖。內部圖塊 BLOCK，在同步更新這一點上可以在合圖的情形下達到跟 XREF 相同的效果，但是，BLOCK 無法對圖層作區別處理，而 XREF 圖塊可以。換言之，分圖引用，能更靈活地對被引用圖層做取捨。</li><li>很多人喜歡合圖的主要原因是覺得拷貝、移動很方便。但其實對於平面圖來說，分圖才更方便。因為 AutoCAD 很早就提供了『帶基點拷貝』和『原位粘貼』，尤其是後者，在建築平面圖各個樓層之間的對位拷貝（移動）來說，最為簡便不過。<br />分圖的各個樓層平面，要具有相同的坐標系，通常可以用 A 軸和 0 軸的交點作為坐標原點和插入點。這樣，你要把標準層的一道墻複製到一層平面，只需要『拷貝』，切換 DWG，『原位粘貼』即可。<br />非對位拷貝（移動）的情況，用『帶基點拷貝』也並不比 COPY 這個命令複雜。<br />而
且，『複製』、『粘貼』不但可以跨圖，還可以在各個 UCS 
裡面任意穿梭。舉個例子：在各個房間的外墻上添加一個空調預留孔。現在已經畫好了一個了，怎樣把他放到橫七豎八還有斜向的墻上去？拷貝再旋轉，再移動？
不，先『帶基點拷貝』，然後在要留孔的墻線上做 UCS, E，再粘貼就可以了。</li><li>樓層的對位檢查，或者跨專業的對位檢查，在分圖，統一坐標系和插入點的情況下，用 XREF 插入底圖即可快速精確對位，這比合圖更有利於組織和合作。當然我也知道，很多人是沒有這個意識的。但是講道理，這是應該做的工作好嗎？風井、管井、電梯井、煙囪就不多說了，陽台、露台這種涉及到面積的地方，不對位檢查能行？合在一張圖上，你怎麼檢查？畫一個輪廓線拷貝過去？說好的方便呢？</li><li>一個總結性的看法<br />有些人對這個回答，甚至對 AutoCAD 本身表示了不屑，認爲他們的習慣大於天。對此，我無意反駁。我想給願意聽取意見的朋友指出一點：可能你現在仍然是一名無需合作的設計師、製圖員，一座孤島。但你最好不要永遠將自己與世隔絕，拒絕合作。<br />要建立團隊意識，適應或者組織、領導一個團隊。<br />要規劃合作方式，考慮專業内部的合作、跨專業的合作、甲方乙方的合作。<br />我在知乎回答的 AutoCAD 相關問題，大多有此考慮，用心看的朋友請留意此點。</li></ol></body></html>